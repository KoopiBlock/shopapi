This is a [Next.js](https://nextjs.org/) project bootstrapped with [`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app).

## Getting Started

First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `pages/index.js`. The page auto-updates as you edit the file.

[API routes](https://nextjs.org/docs/api-routes/introduction) can be accessed on [http://localhost:3000/api/hello](http://localhost:3000/api/hello). This endpoint can be edited in `pages/api/hello.js`.

The `pages/api` directory is mapped to `/api/*`. Files in this directory are treated as [API routes](https://nextjs.org/docs/api-routes/introduction) instead of React pages.

This project uses [`next/font`](https://nextjs.org/docs/basic-features/font-optimization) to automatically optimize and load Inter, a custom Google Font.

## Learn More

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js/) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/deployment) for more details.
\

[index.js

import Head from 'next/head'
import { useState } from 'react';
import styles from '../styles/Home.module.css'
import { getAllCategories } from '../utils/graphql';
import { Navbar, Footer, Product, Header, Cart } from './components';

export async function getStaticProps() {
const categories = await getAllCategories();
return {
props: { categories },
};
}
// export async function getStaticProps() {
// // to be changed, we don't want this to be seen on the client side
// const res = await fetch('http://localhost:3000/api/product');

// if (!res.ok) {
// console.error(res);
// return { props: {} };
// }

// const data = await res.json();

// const products = data.products.edges
// .map(({ node }) => {
// if (node.totalInventory <= 0) {
// return false;
// }

// return {
// id: node.id,
// title: node.title,
// description: node.description,
// imageSrc: node.images.edges[0].node.src,
// imageAlt: node.title,
// price: node.variants.edges[0].node.priceV2.amount,
// slug: node.handle,
// variantId: node.variants.edges[0].node.id
// };
// })
// .filter(Boolean);

// const categories = data.categories.edges.map(({ node }) => {
// return {
// id: node.id,
// title: node.title,
// products: node.products.edges.map(({ node }) => {
// return {
// id: node.id,
// title: node.title,
// description: node.description,
// imageSrc: node.images.edges[0].node.src,
// imageAlt: node.title,
// price: node.variants.edges[0].node.priceV2.amount,
// slug: node.handle,
// variantId: node.variants.edges[0].node.id
// };
// })
// };
// });

// return {
// props: { categories },
// };
// }ddf

export default function Home({ categories }) {
const [selectedCategoryId, setSelectedCategoryId] = useState(categories[0]?.id);

const handleCategoryClick = (categoryId) => {
setSelectedCategoryId(categoryId);
};

const selectedCategory = categories.find((category) => category.id === selectedCategoryId);

return (

<div className={styles.container}>
<Head>
<title>Create Next App</title>
<meta name="description" content="Generated by create next app" />
<link rel="icon" href="/favicon.ico" />
</Head>
<main className={styles.main}>
<h1 className={styles.title}>Store</h1>
<div className={styles.categoryContainer}>

          <div className={styles.categories}>
            {categories.map((category) => (
              <div
                key={category.id}
                className={`${styles.category} ${selectedCategoryId === category.id ? styles.active : ''}`}
                onClick={() => handleCategoryClick(category.id)}
              >
                {category.title}
              </div>
            ))}
          </div>
        </div>
        <div className={styles.productsSection}>
          {selectedCategory?.products.map((product) => (
            <Product key={product.id} product={product} />
          ))}
        </div>
      </main>
    </div>

);
}
]

[
graphql.js (file in utils folder)

import { postToShopify } from './shopify';

export async function getAllCategories() {
const data = await postToShopify({
query: `     query getAllCategories {
        collections(first: 100) {
          edges {
            node {
              id
              title
              products(first: 100) {
                edges {
                  node {
                    id
                    title
                    description
                    handle
                    images(first: 1) {
                      edges {
                        node {
                          src
                          altText
                        }
                      }
                    }
                    variants(first: 1) {
                      edges {
                        node {
                          priceV2 {
                            amount
                            currencyCode
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
  `,
variables: {},
});

const categories = {};

data.collections.edges.forEach(({ node }) => {
if (node.products.edges.length > 0) {
categories[node.id] = {
id: node.id,
title: node.title,
products: node.products.edges.map(({ node: product }) => ({
id: product.id,
title: product.title,
description: product.description,
imageSrc: product.images.edges[0]?.node?.src ?? '/placeholder-image.jpg',
imageAlt: product.images.edges[0]?.node?.altText ?? '',
price: product.variants.edges[0]?.node?.priceV2?.amount ?? 0,
slug: product.handle,
})),
};
}
});

return Object.values(categories);
}

export async function getProductsByCategory(categoryId) {
try {
const data = await postToShopify({
query: `       query getProductsByCategory($categoryId: ID!) {
          collection(id: $categoryId) {
            id
            title
            products(first: 100) {
              edges {
                node {
                  id
                  title
                  description
                  handle
                  images(first: 1) {
                    edges {
                      node {
                        src
                        altText
                      }
                    }
                  }
                  variants(first: 1) {
                    edges {
                      node {
                        priceV2 {
                          amount
                          currencyCode
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
    `,
variables: { categoryId },
});

    if (!data.collection) {
      return [];
    }

    return data.collection.products.edges.map(({ node: product }) => ({
      id: product.id,
      title: product.title,
      description: product.description,
      imageSrc: product.images.edges[0]?.node?.src ?? '/placeholder-image.jpg',
      imageAlt: product.images.edges[0]?.node?.altText ?? '',
      price: product.variants.edges[0]?.node?.priceV2?.amount ?? 0,
      slug: product.handle,
    }));

} catch (error) {
console.log(error);
return [];
}
}
]
